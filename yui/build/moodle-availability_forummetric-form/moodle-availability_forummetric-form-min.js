YUI.add("moodle-availability_forummetric-form",function(b,e){function g(e,t){var t=t?"inline-block":"none",a='<label style="display: block;">';return a+(`<input type="checkbox" name="${e}_enabled"> `+M.util.get_string(e,"availability_forummetric"))+`<span data-input="${e}" class="dtinput ml-2" style="display: ${t};">`+`<input type="date" class="form-control" name="${e}_date">`+`<input type="time" class="form-control" name="${e}_time" step="1">`+"</span>"+"</label>"}function _(e,t){const a=e.one(`input[type=checkbox][name=${t}_enabled]`),n=e.one(`span.dtinput[data-input=${t}]`);a&&n&&a.on("change",()=>{var e=a.get("checked")?"inline-block":"none";n.setStyle("display",e)})}M.availability_forummetric=M.availability_forummetric||{},M.availability_forummetric.form=b.Object(M.core_availability.plugin),M.availability_forummetric.form.initInner=function(e,t){this.metrics=(e??[]).filter(e=>e.metric&&e.name),this.forums=(t??[]).filter(e=>e.id&&e.name)},M.availability_forummetric.form.getNode=function(e){let t='<span class="availability-forummetric">';t=(t+='<select name="forum" class="form-control">')+`<option value="0">${M.util.get_string("allforums","availability_forummetric")}</option>`;for(const n of this.forums)t+=`<option value="${n.id}">${n.name}</option>`;t+='</select><select name="metric" class="form-control">';for(const i of this.metrics)t+=`<option value="${i.metric}">${i.name}</option>`;t=(t=(t=(t=(t=(t=(t=(t=(t+='</select><select name="condition" class="form-control">')+`<option value="morethan">${M.util.get_string("morethan","availability_forummetric")}</option>`)+`<option value="lessthan">${M.util.get_string("lessthan","availability_forummetric")}</option>`)+'</select><input type="number" name="value" class="form-control" min="0">')+g("fromdate",e.fromdate?.enabled??!1))+g("todate",e.todate?.enabled??!1))+`<label data-identifier="engagementinternational" style="display: ${e.metric?.startsWith("maxengagement_")?"block":"none"};">`)+'<input type="checkbox" name="engagementinternational"> '+M.util.get_string("engagement_international","availability_forummetric"))+"</label></span>";var a=b.Node.create(`<span class="form-inline">${t}</span>`);const n=a.one("select[name=forum]"),i=a.one("select[name=metric]");var l=a.one("select[name=condition]"),o=a.one("input[name=value]"),m=a.one("input[name=fromdate_enabled]"),r=a.one("input[name=fromdate_date]"),u=a.one("input[name=fromdate_time]"),c=a.one("input[name=todate_enabled]"),s=a.one("input[name=todate_date]"),d=a.one("input[name=todate_time]"),f=a.one("input[name=engagementinternational]");if(n&&n.set("value",e.forum??0),i&&i.set("value",e.metric??"numreplies"),l&&l.set("value",e.condition??"morethan"),o&&o.set("value",parseInt(e.value??0)),m&&m.set("checked",e.fromdate?.enabled??!1),r&&r.set("value",e.fromdate?.date??null),u&&u.set("value",e.fromdate?.time??null),c&&c.set("checked",e.todate?.enabled??!1),s&&s.set("value",e.todate?.date??null),d&&d.set("value",e.todate?.time??null),f&&f.set("checked",!!e.engagementinternational),!M.availability_forummetric.form.addedEvents){M.availability_forummetric.form.addedEvents=!0,_(a,"fromdate"),_(a,"todate");{l=a;const p=l.one("select[name=metric]"),v=l.one("label[data-identifier=engagementinternational]");p&&v&&p.on("change",()=>{var e=p.get("value").startsWith("maxengagement_")?"inline-block":"none";v.setStyle("display",e)})}b.one(".availability-field").delegate("change",()=>{M.core_availability.form.update()},".availability-forummetric select,input")}return a},M.availability_forummetric.form.fillValue=function(e,t){var a=t.one("select[name=forum]"),n=t.one("select[name=metric]"),i=t.one("select[name=condition]"),l=t.one("input[name=value]"),o=t.one("input[name=fromdate_enabled]"),m=t.one("input[name=fromdate_date]"),r=t.one("input[name=fromdate_time]"),u=t.one("input[name=todate_enabled]"),c=t.one("input[name=todate_date]"),s=t.one("input[name=todate_time]"),t=t.one("input[name=engagementinternational]");e.forum=a?.get("value")??null,e.metric=n?.get("value")??null,e.condition=i?.get("value")??null,e.value=l?.get("value")??null,e.fromdate={enabled:!!o?.get("checked"),date:m?.get("value")??null,time:r?.get("value")??null},e.todate={enabled:!!u?.get("checked"),date:c?.get("value")??null,time:s?.get("value")??null},e.engagementinternational=t?.get("checked")??!1},M.availability_forummetric.form.fillErrors=function(e,t){}},"@VERSION@",{requires:["base","node","moddle-core_availability-form"]});